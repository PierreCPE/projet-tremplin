version: 2

models:
  - name: stg_yellow_taxi_agg
    description: "This model stages the yellow taxi data."
    columns:
      - name: trip_id
        description: "ID of the trip starting with the year_month of the table it came from."
        tests:
          - unique
          - not_null
      - name: VendorID
        description: "ID of the vendor."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: tpep_pickup_datetime
        description: "Date and time when the passenger was picked up."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: tpep_dropoff_datetime
        description: "Date and time when the passenger was dropped off."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: passenger_count
        description: "Number of passengers in the taxi."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: trip_distance
        description: "Distance of the trip in miles."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: RatecodeID
        description: "Rate code for the trip."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: store_and_fwd_flag
        description: "Flag indicating if the trip record was held in vehicle memory before sending to the vendor."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: payment_type
        description: "Payment method used for the trip."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
          - accepted_values:
              values: 
                - 1
                - 2
                - 3
                - 4
                - 5
                - 6
              severity: error
      - name: fare_amount
        description: "Fare amount for the trip."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: extra
        description: "Extra charges for the trip."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: mta_tax
        description: "MTA tax for the trip."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: tip_amount
        description: "Tip amount for the trip."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: tolls_amount
        description: "Tolls amount for the trip."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: improvement_surcharge
        description: "Improvement surcharge for the trip."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"
      - name: total_amount
        description: "Total amount for the trip."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"

      - name: PULocationID
        description: "ID of the pickup location."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"

      - name: DOLocationID
        description: "ID of the dropoff location."
        tests:
          - not_null:
              severity: warn
              warn_if: ">0.15"
              error_if: ">0.5"